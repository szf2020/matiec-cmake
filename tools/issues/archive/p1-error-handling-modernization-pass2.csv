ID,Title,Description,Acceptance,Test_Method,Tools,Dev_Status,Review1_Status,Regression_Status,Files,Dependencies,Notes
B1,Stage3诊断统一化,将stage3剩余检查器的诊断宏改为公共helper并统一ErrorReporter类别,迁移完成且stderr格式与error_count/warning语义不变,cmake --build build-vs --config Release | ctest --test-dir build-vs -C Release -R MatiecApiTest --output-on-failure,manual,DONE,DONE,DONE,stage3/constant_folding.cc | stage3/declaration_check.cc | stage3/enum_declaration_check.cc | stage3/lvalue_check.cc | stage3/print_datatypes_error.cc | stage3/remove_forward_dependencies.cc | stage3/stage3_diagnostics.hh,A1,keep category mapping
B2,Stage1_2诊断桥接,统一lexer/parser错误输出与ErrorReporter桥接并保持现有格式与计数,flex/bison错误路径全部上报且stderr格式不变,cmake --build build-vs --config Release | ctest --test-dir build-vs -C Release -R MatiecApiTest --output-on-failure,manual,DONE,DONE,DONE,stage1_2/iec_bison.yy | stage1_2/iec_flex.ll | stage1_2/stage1_2_diagnostics.hh,B1,keep include stack output
B3,Stage4与CLI错误上报,补齐stage4/CLI关键错误到ErrorReporter并保持输出格式,stage4err与选项错误均上报且输出格式不变,cmake --build build-vs --config Release | ctest --test-dir build-vs -C Release -R MatiecApiTest --output-on-failure,manual,DONE,DONE,DONE,stage4/stage4.cc | stage4/generate_c/generate_c.cc | stage4/generate_iec/generate_iec.cc | main.cc,B1,limit to compiler errors
B4,ErrorReporter细节保留与C API,加入详细错误保留与C API读取路径并补充单测,派生错误format保留且C API返回更完整错误信息,cmake --build build-vs --config Release | ctest --test-dir build-vs -C Release -R MatiecApiTest --output-on-failure,manual,DONE,DONE,DONE,include/matiec/error.hpp | src/error_reporter.cc | src/matiec_lib.cc | tests/unit/test_error_handling.cc | tests/unit/test_matiec_api.cc,B1,avoid breaking errors() API
